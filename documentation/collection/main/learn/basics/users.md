---
_order: 0
title: "Users"
---

Users are stored in your database and is represented by a `User` object within Lucia:

```ts
const user = {
	userId: "laRZ8RgA34YYcgj"
};
```

### User id

The primary way to identify users is by their user id. It's randomly generated by Lucia and it's 15 characters long. You can of course configure it to generate your own user id or let your database handle it.

> With the default option, you can create just over 100 billions users before you have thousandths of a percent chance to get a collision!

### User attributes

By default, only the user id is stored in the user object. Other fields are called _user attributes_ and you can configure your database and Lucia to store additional custom data (email, username, etc). But keep in mind that you should only store as much as you need, and fields unrelated to the authorization process (like the user's submission) should be stored in a separate table.

### Keys

_Keys_ is a key concept of Lucia.

When authenticating users (log in), you get the user with data from an external provider, such as the email from the user's input or Github user id for social login. Keys allow you to link such external data from a _provider_ with Lucia users stored in your database, and you can have multiple keys linked to a user.

Keys are defined with a _provider id_, which is just a unique id for the provider (authentication method), and a _provider user id_, which is the unique identifier of the user within the provider. While you can (and should) have multiple keys with the same provider id, the combination of the provider id and provider user id should be unique. Keys can hold passwords as well, which will be hashed and can be validated with Lucia's API.

For example, for email/password, "email" can be the provider id, the user’s email can be the provider user id, and store the user's password as the key's password. For Github OAuth, "github" can be the provider name and the user’s GitHub user id can be the provider user id.

#### Primary keys

The primary key is the key created alongside the user. The primary key is always linked to the user and cannot be deleted.

## Create users

The [`createUser()`](/reference/api/server-api#createuser) method can be used to create users. This takes an option for the primary key, which will be linked the user, and user attributes.

```ts
import { auth } from "./lucia.js";

await auth.createUser({
	key: {
		providerId,
		providerUserId,
		password
	},
	attributes
});
```

`attributes` should be an empty object with default configuration. Refer to [Store user attributes]() to learn more about storing custom data.

Refer to [Keys]() to learn how to authenticate users using keys.

### With a password key

This is useful when you can't trust the provider to have given you the correct information. For example, in a simple username/password authentication, your users are the provider and you have validate the identity by using passwords.

Lucia will hash the password for you so just pass the raw string.

```ts
import { auth } from "./lucia.js";

try {
	await auth.createUser({
		provider: {
			providerId: "username", // provider id = authentication method
			providerUserId: usernameInput, // the user's username is unique to the user
			password: passwordInput // you don't need to worry about hashing
		},
		attributes: {}
	});
} catch {
	// invalid input
}
```

### Without a password key

This is useful when you can trust the input for the provider name and identifier. When implementing OAuth for example, you can trust that the provider has validated the user and has given you the correct identifier (you will never get the information about of B when user A signs in with the OAuth provider).

```ts
import { auth } from "./lucia.js";

try {
	await auth.createUser({
		provider: {
			providerId: "github", // provider id = authentication method
			providerUserId: githubUserId, // the user's Github user id is unique to the user
			password: null
		},
		attributes: {}
	});
} catch {
	// invalid input
}
```

### With user attributes

```ts
import { auth } from "./lucia.js";

try {
	await auth.createUser({
		provider: {
			// ...
		},
		attributes: {
			username: "user1234",
			profile: null
		}
	});
} catch {
	// invalid input
}
```

### Without creating a key

If you _just_ need to store users and authenticate users by yourself, you can set `provider` as `null`. Avoid doing this if you plan on using keys later or unsure.

## Get users

The [`getUser()`]() method can be used to get a user from a user id. This will throw an error if the user isn’t found.

```ts
import { auth } from "./lucia.js";

const user = await auth.getUser(userId);
```

## Update user attributes

A user's attributes can be updated using the [`updateUserAttributes()`]() method. Only the user data attribute (column) that needs to updated needs to be passed.

**Make sure to invalidate all sessions of the user on password or privilege level change.** You can create a new session to prevent the current user from being logged out.

```ts
import { auth } from "./lucia.js";

const user = await auth.updateUserAttributes(userId, partialUserAttributes);
```

### Example

```ts
import { auth } from "./lucia.js";

try {
	const user = await auth.updateUserAttributes(userId, {
		username: "user1234",
		profile_picture: null
	});
} catch {
	// invalid input
}
```

## Delete users

Users can be deleted using the [`deleteUser()`]() method. All sessions and keys of the target user will be deleted. This method will succeed regardless of the validity of the user id.

```ts
import { auth } from "./lucia.js";

const user = auth.deleteUser(userId);
```

## Configure users

### Custom user id generation

You can generate your own user ids by setting [`generateCustomUserId()`](), which can either be synchrnous or asynchronous. You can return on `null` to let your database handle the user id generation.

If you need to generate a cryptographically random string consisting of alphabets and numbers, Lucia provides [`generateRandomString()`](). This function uses the [`nanoid`]() package.

```ts
import { generateCustomUserId } from "lucia-auth";

lucia({
	generateCustomUserId: () => {
        return `user_${generateCustomUserId(8)}` // example result: "user_yhwKf2yn"
    }
});
```
